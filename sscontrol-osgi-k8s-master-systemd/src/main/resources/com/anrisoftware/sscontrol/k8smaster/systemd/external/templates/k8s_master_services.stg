kubeApiserverService(parent, vars) ::= <<
# Authors
# https://koji.fedoraproject.org/koji/buildinfo?buildID=831577
[Unit]
Description=Kubernetes API Server
Documentation=https://github.com/GoogleCloudPlatform/kubernetes
After=network.target
After=etcd.service

[Service]
EnvironmentFile=-<vars.configDir>/config
EnvironmentFile=-<vars.configDir>/apiserver
User=<vars.user>
ExecStart=<vars.binDir>/kube-apiserver \
        $KUBE_LOGTOSTDERR \
        $KUBE_LOG_LEVEL \
        $KUBE_ETCD_SERVERS \
        $KUBE_API_ADDRESS \
        $KUBE_API_PORT \
        $KUBELET_PORT \
        $KUBE_ALLOW_PRIV \
        $KUBE_SERVICE_ADDRESSES \
        $KUBE_ADMISSION_CONTROL \
        $KUBE_API_ARGS
Restart=on-failure
Type=notify
LimitNOFILE=65536

[Install]
WantedBy=multi-user.target
>>

kubeControllerManagerService(parent, vars) ::= <<
# Authors
# https://koji.fedoraproject.org/koji/buildinfo?buildID=831577
[Unit]
Description=Kubernetes Controller Manager
Documentation=https://github.com/GoogleCloudPlatform/kubernetes

[Service]
EnvironmentFile=-<vars.configDir>/config
EnvironmentFile=-<vars.configDir>/controller-manager
User=kube
ExecStart=<vars.binDir>/kube-controller-manager \
        $KUBE_LOGTOSTDERR \
        $KUBE_LOG_LEVEL \
        $KUBE_MASTER \
        $KUBE_CONTROLLER_MANAGER_ARGS
Restart=on-failure
LimitNOFILE=65536

[Install]
WantedBy=multi-user.target
>>

kubeSchedulerService(parent, vars) ::= <<
# Authors
# https://koji.fedoraproject.org/koji/buildinfo?buildID=831577
[Unit]
Description=Kubernetes Scheduler Plugin
Documentation=https://github.com/GoogleCloudPlatform/kubernetes

[Service]
EnvironmentFile=-<vars.configDir>/config
EnvironmentFile=-<vars.configDir>/scheduler
User=kube
ExecStart=<vars.binDir>/kube-scheduler \
        $KUBE_LOGTOSTDERR \
        $KUBE_LOG_LEVEL \
        $KUBE_MASTER \
        $KUBE_SCHEDULER_ARGS
Restart=on-failure
LimitNOFILE=65536

[Install]
WantedBy=multi-user.target
>>
